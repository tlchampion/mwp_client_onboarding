<html>

<head>
    <title>MyWealthPlan</title>
    <link rel="stylesheet" type="text/css" href="form.css">
    <script src='https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js'></script>
</head>

<body>


    <div id="heading">
        <h1>Thank You</h1>
        Your contact information has been received. We will contact you in the near future to schedule an
        initial meeting to discuss your goals.

        <br>
        <br>




    </div>

    <!--
   <div class="wrapper">
    <div class="form-signin">
      <h2 class="form-signin-heading">Please Click to See Your Saved Information</h2>
      <button class="btn btn-lg btn-primary btn-block"  onclick="retrive_information();">Show</button>

      </br>
       <div  id="id_1"></div>
       <div class="form-control" id="name_1"></div>
       <div class="form-control" id="last_name_1"></div>
       <div class="form-control" id="address_1"></div>
       <div class="form-control" id="mob_no_1"></div>
    </div>
  </div>
-->
    </div>
    <script type="text/javascript">

        async function loadWeb3() {
            if (window.ethereum) {
                window.web3 = new Web3(window.ethereum);
                await window.ethereum.enable();
                const accounts = await window.web3.eth.getAccounts();
                window.currentAccount = accounts[0]
            }
        }

        async function loadContract() {
            // set ABI
            var abi = [
                {
                    "constant": false,
                    "inputs": [
                        {
                            "internalType": "string",
                            "name": "_f_name",
                            "type": "string"
                        },
                        {
                            "internalType": "string",
                            "name": "_l_name",
                            "type": "string"
                        },
                        {
                            "internalType": "string",
                            "name": "_email",
                            "type": "string"
                        },
                        {
                            "internalType": "string",
                            "name": "_portfolio",
                            "type": "string"
                        }
                    ],
                    "name": "store_information",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function"
                }
            ]
            //set contract address
            var contractAddress = '0xb06B0bE584775842ECeA4E2c70B13E433043c96A';

            return await new window.web3.eth.Contract(abi, contractAddress);
        }

        async function store_information() {
            const contract = await loadContract()
            await contract.methods
                .store_information(
                    document.getElementById("FirstName").value,
                    document.getElementById("LastName").value,
                    document.getElementById("EMail").value,
                    document.getElementById("Portfolio").value,


                )
                .send({ from: window.currentAccount })
                .then(function (receipt) {

                    // receipt can also be a new contract instance, when coming from a "contract.deploy({...}).send()"
                });
            window.alert("much thanks");
            window.location.href = "https://www.google.com";


        }

        function formSubmit() {
            validateForm();
            window.alert("Thank You");
            store_information();




        }




        function validateForm() {
            var f_name =
                document.getElementById("FirstName").value;
            var l_name =
                document.getElementById("LastName").value;
            var email =
                document.getElementById("EMail").value;
            var port =
                document.getElementById("Portfolio").value;

            //Javascript reGex for Email Validation.
            var regEmail = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/g;
            // Javascript reGex for Phone Number validation.
            var regPhone = /^\d{10}$/;
            // Javascript reGex for Name validation
            var regName = /\d+$/g;

            if (f_name == "" || regName.test(f_name)) {
                window.alert("Please enter your first name");
                f_name.focus();
                return false;
            }

            if (l_name == "" || regName.test(l_name)) {
                window.alert("Please enter your last name");
                l_name.focus();
                return false;
            }


            if (email == "" || !regEmail.test(email)) {
                window.alert("Please enter a valid e-mail address.");
                email.focus();
                return false;
            }

            if (port.selectedIndex == -1) {
                window.alert("Please enter your portfolio choice.");
                port.focus();
                return false;
            }



        }




        async function retrive_information() {
            const contract = await loadContract()
            await contract.methods.retrive_information().call({ from: window.currentAccount }).then(function (result) {
                document.getElementById("name_1").innerHTML = "Your First Name is : " + result[1];
                document.getElementById("last_name_1").innerHTML = "Your Last Name is : " + result[2];
                document.getElementById("email_1").innerHTML = "Your Email is : " + result[3];
                document.getElementById("phone_1").innerHTML = "Your Mobile No is : " + result[4];
            });
        }

        async function load() {
            await loadWeb3();
            window.contract = await loadContract();
        }

        load();




    </script>
</body>

</html>
